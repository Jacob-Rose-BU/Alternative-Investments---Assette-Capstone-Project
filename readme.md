# -*- coding: utf-8 -*-
"""README.md

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1s92K3u18Ovn97Q92CMBBFI_Df_tleNTZ

# Alternatives Investment Data Pipeline ‚Äì MSBA Capstone 2025

## Project Overview

This project, developed in collaboration with Assette, builds a structured, automated data pipeline designed to support ESG-focused alternative investment strategies. Using a combination of public APIs, synthetic logic, and Python-based transformation layers, our team built a scalable architecture to calculate performance, aggregate ESG data, and structure inputs into Snowflake, Excel, and Python environments.

---

## Objectives

- Ingest and transform data from multiple sources (Yahoo Finance, World Bank, OpenRouter API, synthetic inputs).
- Calculate performance and benchmark metrics at both the portfolio and security level.
- Develop synthetic ESG scoring logic for portfolio holdings.
- Organize the database into institutional-grade tables and establish relationships for fact sheet generation.
- Enable seamless integration into Snowflake and CSV/Excel output pipelines.

---

## Data Flow Diagram

Below is the logical flow of tables in our pipeline, from product setup to final outputs used in fact sheet generation:

```
PRODUCTMASTER
‚îÇ
‚îú‚îÄ‚îÄ PRODUCTATTRIBUTES
‚îÇ
‚îú‚îÄ‚îÄ PORTFOLIOGENERALINFORMATION
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ HOLDINGSDETAILS
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SECURITY_MASTER
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SECURITY_PERFORMANCE_HISTORY
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ PORTFOLIOPERFORMANCE
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ PORTFOLIOBENCHMARKASSOCIATION
‚îÇ       ‚îî‚îÄ‚îÄ BENCHMARKGENERALINFORMATION
‚îÇ           ‚îú‚îÄ‚îÄ BENCHMARKPERFORMANCE
‚îÇ           ‚îî‚îÄ‚îÄ BENCHMARKCHARACTERISTICS
‚îÇ
‚îú‚îÄ‚îÄ HR_INFORMATION
‚îî‚îÄ‚îÄ DISCLOSURE_INFORMATION
```

## üõ†Ô∏è Code-to-Table Mapping

The table below outlines which `.py` file(s) generate each table in our top-down data flow, along with a brief description of each table‚Äôs purpose.

| **.py File(s)**                     | **Table Name**                    | **Description**                                                                 |
|------------------------------------|----------------------------------|---------------------------------------------------------------------------------|
| `productmaster.py`                 | `PRODUCTMASTER`                  | Stores metadata for each product including product code, name, and strategy.   |
| `portfoliogeneralinformation.py`   | `PORTFOLIOGENERALINFORMATION`    | General metadata for each portfolio (e.g., category, region, product linkage). |
| `yfinance_related_tables.py`       | `HOLDINGSDETAILS`                | Portfolio holdings, weights, prices, quantities, and security-level info.      |
| `security_country.py`,             | `SECURITY_MASTER`                | Adds country-level ESG enrichment to securities based on origin             
  `yfinance_related_tables.py`       | `SECURITY_MASTER`                | ESG-related metadata at the security level (e.g., region, CO‚ÇÇ, industry).      |
| `yfinance_related_tables.py`       | `SECURITY_PERFORMANCE_HISTORY`   | Historical performance of each security including prices and return drivers.   |
| `portfolioperformance.py`  | `PORTFOLIOPERFORMANCE`           | Aggregated portfolio-level performance including alpha and ESG scoring.        |
| `portfoliobenchmarkassociation.py` | `PORTFOLIOBENCHMARKASSOCIATION`  | Mapping between portfolios and their associated benchmarks.                    |
| `yfinance_related_tables.py`       | `BENCHMARKGENERALINFORMATION`    | High-level details on each benchmark (e.g., name, symbol, daily performance).  |
| `yfinance_related_tables.py`       | `BENCHMARKPERFORMANCE`           | Performance history of each benchmark.                                         |
| `yfinance_related_tables.py`       | `BENCHMARKCHARACTERISTICS`       | Sector, style, and regional exposure characteristics of benchmarks.            |
| `hr_and_disclosure_files.py`       | `HR_INFORMATION`                 | Team bios, employment status, job titles, and personnel details.               |
| `hr_and_disclosure_files.py`       | `DISCLOSURE_INFORMATION`         | Legal, regulatory, and general footnotes for fact sheet content.               |


---

## Core Tables & Flow

| Table Name                     | Data Sources                            | Destination        | Purpose & Flow |
|-------------------------------|------------------------------------------|--------------------|----------------|
| `PRODUCTMASTER`               | Synthetic, OpenRouter API               | Python DataFrame   | Top-level metadata for products. Feeds into all portfolio-level tables. |
| `PRODUCTATTRIBUTES`           | Synthetic                               | Python DataFrame   | Attribute tags linked to products (e.g., asset class, region). FK to `PRODUCTMASTER`. |
| `PORTFOLIOGENERALINFORMATION` | Synthetic                               | Python DataFrame   | Basic portfolio info (ID, inception date). FK to `PRODUCTMASTER`. |
| `PORTFOLIOPERFORMANCE`        | YFinance API                            | Python DataFrame   | Returns over time at the portfolio level. Pulls from holding performance data. |
| `HOLDINGSDETAILS`             | YFinance API, World Bank API            | Python DataFrame   | Security-level holdings and portfolio weight. FK to `PORTFOLIOGENERALINFORMATION`. |
| `SECURITY_MASTER`            | YFinance API, World Bank API            | Snowflake          | Security identifiers + ESG scoring inputs. Referenced by `HOLDINGSDETAILS`. |
| `SECURITY_PERFORMANCE_HISTORY`| YFinance API                            | Snowflake          | Historical security prices and returns. Feeds `PORTFOLIOPERFORMANCE`. |
| `PORTFOLIOBENCHMARKASSOCIATION` | Synthetic                              | Python DataFrame   | Links each portfolio to a benchmark. FK to `BENCHMARKGENERALINFORMATION`. |
| `BENCHMARKGENERALINFORMATION`| YFinance API                            | Python DataFrame   | Metadata for benchmark funds or indexes. |
| `BENCHMARKPERFORMANCE`        | YFinance API                            | Python DataFrame   | Benchmark return series. Used to compare vs. portfolio. |
| `BENCHMARKCHARACTERISTICS`    | YFinance API                            | Python DataFrame   | Details style, region, and sector exposure of benchmark. |
| `HR_INFORMATION`              | Synthetic                               | Excel              | Qualitative background on portfolio managers. Manually loaded. |
| `DISCLOSURE_INFORMATION`      | Synthetic                               | Excel              | Legal/regulatory disclosures shown in fact sheets. Manually maintained. |

---

## Data Flow Summary

**Data Sources:**
- **Yahoo Finance API:** Security prices, returns, and fundamentals
- **World Bank API:** ESG indicators at the country level
- **OpenRouter API:** Commentary for synthetic fund/product data
- **Synthetic Logic:** Used to generate ESG multipliers, fallback data, and team/disclosure information

**Data Destinations:**
- **Python DataFrames:** Main transformation layer
- **Snowflake:** Final storage for structured performance and security tables
- **Excel:** Qualitative static inputs (bios, disclosures)

---

## ESG Scoring Logic

To fill the gaps in publicly reported ESG data, we created a synthetic scoring framework:

- **Base ESG Score:** Pulled directly from security if available (via yFinance or external).
- **Fallback 1:** Use country-level ESG score from the World Bank API (e.g., corruption, education, gender data).
- **Fallback 2:** Use peer sector average or synthetic sector-region multiple (e.g., Tech sector √ó US = 0.7).
- **Composite Score:** Roll holdings-level ESGs into a weighted portfolio ESG score.
- **Configurable Multipliers:** Used to scale ESG scoring based on priority criteria (e.g., diversity, carbon emissions).

---

## Outputs

All tables in the data pipeline were purpose-built to flow into our final investment fact sheet, covering both quantitative and qualitative insights:

- Portfolio metadata, strategy, and product info from `PRODUCTMASTER` and `PORTFOLIOGENERALINFORMATION`
- Return series and performance attribution from `PORTFOLIOPERFORMANCE` and `SECURITY_PERFORMANCE_HISTORY`
- Top holdings, portfolio weights, and ESG scoring from `HOLDINGSDETAILS` and `SECURITY_MASTER`
- Benchmark comparisons and risk style classification from the benchmark-related tables
- Regulatory disclosures and qualitative team bios from Excel-based `DISCLOSURE_INFORMATION` and `HR_INFORMATION`
- All outputs structured to align with Assette‚Äôs fact sheet architecture, including Snowflake schemas, Excel prototypes, and markdown summaries

---

## Team

This project was developed by the Alternatives Team as part of the MSBA Capstone 2025 program at Boston University.

**Team Members:**
- Crystal Leatvanich
- Jacob Rose
- Kendall Sims

**Thank You:**  
Advisors from Assette and Boston University for guidance throughout project sprints.
"""
